# Lines

**Table of contents**

- [Introduction](#introduction)
- [Concepts](#concepts)
  - [Segments](#segments)
  - [Presets](#presets)
  - [Preset Editor](#preset-editor-concept)
  - [Preset Sequencer](#preset-sequencer-concept)
- [Norns controls](#norns-controls)
- [Main menu](#main-menu)
- [Preset Sequencer](#preset-sequencer)
- [Presets (list)](#presets-list)
- [Preset Editor](#preset-editor)
  - [Time](#time)
  - [Level](#level)
  - [Shape](#shape)
  - [Jump](#jump)
  - [Conditional Jumps 1 and 2](#conditional-jumps-1-and-2)
  - [Ping](#ping)
- [Settings](#settings)

---

## Introduction

This spec is for the Norns script, **Lines** (working title).

Lines is inspired by the Rossum Electro Control Forge and its Satellite Eurorack modules that are sequencable function generators that generate CV contours with randomness and conditionals that make for interesting, evolving modulations—especially when you interconnect multiple Control Forge and Satellite modules as they can multiply the complexity and randomness tremendously. That said, a limitation to these modules is that they can only generate a single CV contour. Well, technically there are two contours: one is an inversion of contour 1, and two trigger outputs; however, those trigger outputs are often used for incrementing/decrementing the sequence of itself or other Satellite modules. One limitation is the functionality that is involved with conditionally triggering other Satellite modules' sequences requires outputs from the modules themselves, which could be used for modulating other things outside of the CV contour shaping realm. Additionally, these modules take up rack space—i.e., 22 HP for a single Control Forge and 12 HP for the additional Satellites.

Lines was built to work with **Crow**, a 2 HP Eurorack module built by Monome and Whimsical Raps, that has 4 CV outputs and 2 CV inputs for modulation and interaction with other modules. Lines functions as a "brain" that passes along instructions to Crow, telling it what CV contour to draw (or trigger) at any given time, while handling the randomization and sequence iteration internally. Additionally, Norns provides a visual that enables the viewer to easily see how sequences are interacting via internal conditional steps and randomization, as well as external triggers and conditionals. The sky's the limit for how these sequences are programmed to evolve.

---

## Concepts

Conceptually, Lines is organized into three structural building blocks: **segments**, **presets**, and the **preset sequencer**.

### Segments

Segments are the finest grain concept. They are information telling a given preset what shape to produce, what level in volts the shape should end at, and for how long to produce it, and finally, where in the preset the segment should go after it's finished, conditionally and unconditionally (more on this in a bit).

### Presets

Presets contain up to 8 segments and are mostly there for organizational purposes. It's possible for a preset to contain logic that routes to another preset; in fact, that's partially what makes these so powerful! It's up to the user to decide how to organize presets. Some examples include: a preset that stores an arpeggiated sequence of tones in C major; a preset that functions as a simple LFO or envelope generator; a preset that sends semi randomized triggers that approach certain values at the final segment. Segments can jump around within a preset, or can even jump between presets! This means individual presets can possess high degrees of complexity—it's up to you how you prefer to organize that complexity.

### Preset Editor (concept)

This is the page where a preset and its segments are edited.

### Preset Sequencer (concept)

The Preset Sequencer is exactly how it sounds: a sequence of presets that the user changes via varying algorithms and probabilistic sequencing, either using the Norns interface, or via CV 1 and 2 control on Crow.

The Preset Sequencer page displays information about which presets are playing for each CV output on Crow. Additionally, the contours that are generated by each CV output are also displayed on the screen to help visualize the "flavor" of each preset within each sequence.

---

## Norns controls

Norns has **K1–K3** (keys) and **E1–E3** (encoders), which increment as you move from left to right. **K1** is on the far upper left and **K3** is on the bottom right. On norns, **K1 is system-reserved** and always opens the system menu; the script never receives K1, so Lines uses **K2** and **K3** (and E1–E3) only.

---

## Main menu

When you start the script, you'll land on the main menu page.

- **E1** — Move to select menu items; icons light up for the selected item.
- **K3** — Enter the selected page.
- **K2** — Return to the main menu from any page (back).

---

## Preset Sequencer

The preset sequencer page is titled **Preset Sequencer** only (do not use "Canvas"). It contains each sequence of presets that are assigned to each line. A sequence can contain up to **8 presets**. Note that a segment within a preset can be assigned to jump from one preset to another—these jumps are not treated as a jump in the preset sequencer. Instead, view each preset in the sequencer as the "starter" or "seed" preset that will kick off a preset and allow that preset to jump however you intend with your design.

### Building a sequence

- **E2** — Navigate through presets. A text cursor indicates:
  - **(1)** The space between two presets is selected.
  - **(2)** The preset itself is selected.

**When a preset is highlighted (1):** Options include **Edit**, **Copy**, **Paste**, and **Delete**. Edit routes to the Preset Editor (where you can edit and Save or Save As the existing preset). Copy copies the preset. Paste: pasting while another preset is highlighted overwrites the highlighted preset; pasting when the space between two presets is selected inserts a preset between those presets.

**When the space between two presets is highlighted:** Options are **Add** or **Paste**. Add routes you to the Presets page to select a preset to add to the Preset Sequencer.

- **E3** — Choose the option (Edit, Copy, Paste, Delete, or Add).
- **K3** — Execute the selected option.

The preset name is displayed at the bottom right of the screen if a preset is selected.

### Playback

- Navigate to the bottom right using **E2** and press **K3** on the **play** icon to start the preset sequencer.
- Press **K3** on the **stop** icon to stop.
- Press **K3** again while on the stop icon to restart.

---

## Presets (list)

The presets page is used to select either pre-existing presets to insert into the sequencer, or for creating or editing current presets.

- **E2** — Scroll through presets.
- **K3** — Add a preset to the sequencer, or edit the selected preset.
- **Delete preset** — Via PARAMETERS: **lines** → **Delete preset** set to **yes** (deletes the selected preset on the Presets list). Use E2 to select the preset first, then K1 → PARAMETERS → lines → Delete preset → E3 to yes.

---

## Preset Editor

The Preset Editor is dense; it contains the parameters you need when designing a preset for the sequencer.

- **E1** — Select which segment (1–8) you are editing.
- **E2** — Move through parameters (e.g. Time, Level, Shape, Jump).
- **E3** — Change the value for the selected parameter (e.g. shape type, level value).

---

### Time

Time can be in either **beats** or **seconds**. Beats are synchronized to a clock input on either CV1 or CV2—you select this in the Settings page. Seconds begin counting as soon as the first run pulse is received. Beats can go up to 9999; time in seconds also goes up to 9999.

---

### Level

Level is the voltage you want at the end of the segment. Four options:

| Option | Description |
|--------|-------------|
| **abs** | Absolute value of voltage (-5–5V). |
| **absQ** | Absolute quantized voltage, displayed as Note (e.g. G#, C, D). |
| **rel** | Relative change compared to the prior segment's end voltage. Values that exceed -5–5V are capped to that range. |
| **relQ** | Relative quantized voltage in semitones. |

---

### Shape

The function curve shape. Current options: **sine**, **square**, **logarithmic**, **exponential**, and **linear**. (More shapes may be added later.)

---

### Jump

Defines the segment and preset to jump to once the current segment completes. If no segment or preset is specified, the preset stops playing.

---

### Conditional Jumps 1 and 2

There are two conditional jump parameters that are assignable to either the **Jump** or **Ping** parameters. They function similarly to Octatrack MkII scene assignments.

- **Conditional jump highlight** — (On norns, K1 is system-reserved; this could be mapped to params or another key in future.) A crosshatch would appear over segment/preset arguments that are assignable to the jump conditions.
- You can only assign **one** conditional jump parameter to a segment parameter at a time; values already assigned to one conditional are greyed out and unassignable if the other conditional is already assigned.
- If the condition is met when the segment completes, the conditional jump target (Jump or Ping) is used instead of the default.

**Conditional jump arguments:**

| Argument | Description |
|----------|-------------|
| **Conditional** | 1 or 2 — which conditional slot this applies to. |
| **Input** | Defines the input used to evaluate the condition. Options: **Above (>)** , **Above Equals (>=)** , **Below (<)** , **Below Equals (<=)** , **Equals (=)** , **Between (<>)** , **Outside (><)**. The input can be voltage from CV1 or CV2, or the voltage from another Line. |
| **Value** | The voltage value considered; range -5–5V. |

---

### Ping

A **Ping** is a purely internal equivalent to an output trigger in Control Forge. It does not send triggers outside Crow; instead it sends an internal signal to another **Line** to change its preset in the preset sequencer.

Options: select the **Line** and choose **Increment**, **Decrement**, or **Reset** the preset index for that line.

---

## Settings

The settings page determines how Lines operates in the context of the broader Eurorack system (e.g. whether to sync to a clock and run signal on CV1).

| Setting | Description |
|---------|-------------|
| **Ext Clock** | External clock assignable to CV1 or CV2. |
| **Run** | External run signal assignable to CV1 or CV2. |
| **Quantize** | Boolean — quantizes start/stop commands in the Preset Sequencer to the external clock. |
